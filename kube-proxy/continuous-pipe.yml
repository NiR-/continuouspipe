tasks:
    images:
        build:
            services:
                web:
                    image: docker.io/continuouspipe/kube-proxy
                    naming_strategy: sha1
    deployment:
            deploy:
                cluster: ${CLUSTER}
                environment:
                    name: '"kube-proxy-" ~ code_reference.branch'
                services:
                    web:
                        specification:
                            accessibility:
                                from_external: true
                            ports:
                              - 8080
                        deployment_strategy:
                            readiness_probe:
                                type: tcp
                                port: 8080
                            liveness_probe:
                                initial_delay_seconds: 5
                                timeout_seconds: 5
                                period_seconds: 5
                                type: https
                                port: 8080
                                path: /healthz