#!/bin/bash

export START_HTTP=${START_HTTP:-true}
export START_WORKER=${START_WORKER:-true}
export FIREBASE_DATABASE_NAME=${FIREBASE_DATABASE_NAME:-$FIREBASE_APP}

if [[ ! -v "$FIREBASE_SERVICE_ACCOUNT_PATH" ]]; then
    LOCAL_SERVICE_ACCOUNT_PATH="/app/var/${FIREBASE_SERVICE_ACCOUNT_PATH#./runtime/}"

    export FIREBASE_SERVICE_ACCOUNT=${FIREBASE_SERVICE_ACCOUNT:-$(cat $LOCAL_SERVICE_ACCOUNT_PATH | base64)}
fi

exec node /app/main.js
