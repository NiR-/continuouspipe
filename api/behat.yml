default:
    suites:
        application:
            contexts:
                - TideContext:
                    - @command_bus
                    - @event_bus
                    - @river.event_store
                    - @river.file_system_resolver.fake
                    - @river.tide_factory
                    - @river.view.tide_repository
                - Tide\TasksContext:
                    - @event_bus
                    - @river.repository.tide
                - LoggingContext:
                    - @log_stream.event_store.in_memory
                - GitHubContext:
                    - @kernel
                    - @river.code_status_updater
                    - @river.github.pull_request_deployment_notifier
                    - @river.github.pull_request_resolver
                    - @river.pipe_client
                - FlowContext:
                    - @kernel
                    - @security.token_storage
                    - @river.repository.flow
                    - @repository_river.code_repository_repository
                    - @security.authenticator.client
                    - @river.pipe_client.fake
                - Task\BuildContext:
                    - @river.event_store
                    - @event_bus
                - Task\DeployContext:
                    - @river.event_store
                    - @event_bus
                - Task\RunContext:
                    - @kernel
                    - @runner.client
                - OrganisationContext:
                    - @kernel
                    - @repository_river.organisation_repository
                - RepositoryContext:
                    - @kernel
                    - @repository_river.code_repository_repository

    extensions:
        Behat\Symfony2Extension:
            kernel:
                env: test

    gherkin:
        filters:
            tags: "~@wip"


smoke:
    suites:
        application:
            contexts:
                - FlowContext:
                    - @kernel
                    - @security.token_storage
                    - @river.repository.flow
                    - @repository_river.code_repository_repository
                    - @security.authenticator.client
                    - @river.pipe_client.fake
                - TideContext:
                    - @command_bus
                    - @event_bus
                    - @river.event_store
                    - @river.file_system_resolver.fake
                    - @river.tide_factory
                    - @river.view.tide_repository
                - GitHubContext:
                    - @kernel
                    - @river.code_status_updater
                    - @river.github.pull_request_deployment_notifier
                    - @river.github.pull_request_resolver
                    - @river.pipe_client

    extensions:
        Behat\Symfony2Extension:
            kernel:
                env: smoke_test

    gherkin:
        filters:
            tags: "@smoke && ~@wip"
