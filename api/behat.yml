default:
    suites:
        application:
            contexts:
                - SecurityContext:
                    - @security.token_storage
                    - @security.authenticator.client
                - TideContext:
                    - @command_bus
                    - @event_bus
                    - @river.event_store
                    - @river.file_system_resolver.fake
                    - @river.tide_factory
                    - @river.view.tide_repository
                    - @kernel
                    - @river.commit_resolver
                - Tide\TasksContext:
                    - @event_bus
                    - @river.repository.tide
                - LoggingContext:
                    - @log_stream.event_store.in_memory
                - GitHubContext:
                    - @kernel
                    - @river.code_status_updater
                    - @river.github.pull_request_resolver
                    - @river.pipe_client
                    - @river.event_store
                    - @river.github.http_client
                - FlowContext:
                    - @kernel
                    - @river.repository.flow
                    - @repository_river.code_repository_repository
                    - @security.authenticator.client
                    - @river.pipe_client.fake
                    - @authenticator.team_repository
                - Task\BuildContext:
                    - @river.event_store
                    - @event_bus
                - Task\DeployContext:
                    - @river.event_store
                    - @event_bus
                    - @river.pipe_client
                    - @river.task.deploy.naming.environment_strategy
                - Task\RunContext:
                    - @kernel
                    - @river.pipe_client
                    - @jms_serializer
                - Task\WaitContext: ~
                - OrganisationContext:
                    - @kernel
                    - @repository_river.organisation_repository
                - RepositoryContext:
                    - @kernel
                    - @repository_river.code_repository_repository
                - TideConfigurationContext:
                    - @river.tide_configuration_factory
                - TideSummaryContext:
                    - @kernel
                - AnalyticsContext:
                    - @river.keen.client.traceable

    extensions:
        Behat\Symfony2Extension:
            kernel:
                env: test

    gherkin:
        filters:
            tags: "~@wip"


smoke:
    suites:
        application:
            contexts:
                - SecurityContext:
                    - @security.token_storage
                    - @security.authenticator.client
                - FlowContext:
                    - @kernel
                    - @river.repository.flow
                    - @repository_river.code_repository_repository
                    - @security.authenticator.client
                    - @river.pipe_client.fake
                    - @authenticator.team_repository
                - TideContext:
                    - @command_bus
                    - @event_bus
                    - @river.event_store
                    - @river.file_system_resolver.fake
                    - @river.tide_factory
                    - @river.view.tide_repository
                    - @kernel
                    - @river.commit_resolver
                - GitHubContext:
                    - @kernel
                    - @river.code_status_updater
                    - @river.github.pull_request_resolver
                    - @river.pipe_client
                    - @river.event_store
                    - @river.github.http_client
                - TideConfigurationContext:
                    - @river.tide_configuration_factory
                - Tide\TasksContext:
                    - @event_bus
                    - @river.repository.tide

    extensions:
        Behat\Symfony2Extension:
            kernel:
                env: smoke_test

    gherkin:
        filters:
            tags: "@smoke && ~@wip"
